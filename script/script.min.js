import{saveTeam,saveAnswer}from"./data.js";let currentIndex=0;displayCurrentItem();const answers=document.querySelectorAll(".answer");let qidForRadio="";function displayCurrentItem(){if("undefined"!=typeof steps){if(currentIndex>=0&&currentIndex<steps.length){const currentItem=steps[currentIndex],resultDiv=document.getElementById("w_result"),w_titleDiv=document.getElementById("w_title"),w_contentDiv=document.getElementById("w_content"),w_image=document.getElementById("w_image"),w_directions=document.getElementById("w_directions"),w_quiz=document.getElementById("w_quiz"),w_infoDiv=document.getElementById("w_info"),w_warningDiv=document.getElementById("w_warning"),w_mediaDiv1=document.getElementById("w_media_1");w_titleDiv.innerHTML=`${currentItem.name}`,w_contentDiv.innerHTML=`${currentItem.place}`,w_image.innerHTML=`<img src='assets/img/${currentItem.image}'>`,currentItem.video&&(w_image.innerHTML=`<video width='100%' controls loop autoplay><source src='assets/vid/${currentItem.video}' type='video/mp4'></video>`),""!=currentItem.info?w_infoDiv.innerHTML=`${currentItem.info}`:w_infoDiv.innerHTML="",""!=currentItem.access?w_warningDiv.innerHTML=`${currentItem.access}`:w_warningDiv.innerHTML="",""!=currentItem.audio_direction?w_directions.innerHTML=`<div class="directions-wrap"> <div class="audio-cntr"><audio id="audioDirections" autoplay controls controlsList="nodownload"><source src="${currentItem.audio_direction}" type="audio/mp3"></audio></div></div>`:w_directions.innerHTML="";let subChildHtml="";for(const key in currentItem.questions)if(currentItem.questions.hasOwnProperty(key)){let qid=extractQuestionID(currentItem.questions[key]),questionAndAnswer=removeQuestionID(currentItem.questions[key]),question=removeTextInBrackets(questionAndAnswer),answers=extractTextBetweenBrackets(questionAndAnswer),answerOptions="",radioOptions="",answerNum=1;answers.split(",").forEach((function(item){answerOptions+='<div class="answer answer-enable" id="q'+qid+answerNum+'">'+item+"</div>",radioOptions+='<input type="radio" name="boxRadio-opt-'+qid+'" id="opt-'+qid+answerNum+'" value="q'+qid+answerNum+'">',answerNum++})),subChildHtml+=`<p class="question">${question}</p>`,subChildHtml+=`<div class="options opt-${qid}">${answerOptions}</div>`,subChildHtml+=`<div id="radioForm" class="hide">${radioOptions}</div>`}w_quiz.innerHTML=subChildHtml,""!=currentItem.audio_talk?w_mediaDiv1.innerHTML=`<div class="audio-wrap"><div class="dr-green"><img src="img/dr-green.png"></div><div class="audio-cntr"><audio id="myAudio1" controls controlsList="nodownload"><source src="${currentItem.audio_talk}" type="audio/mp3"></audio></div></div>`:w_mediaDiv1.innerHTML=""}else console.log("No more items in this direction.");resetAnimations()}else console.log("exiting DisplayCurrentItem as no steps")}function resetAnimations(){addClassToElements("answer","answer-enable")}function addClassToElements(className,newClass){const elements=document.getElementsByClassName(className);for(let i=0;i<elements.length;i++)elements[i].classList.add(newClass)}function removeClassFromElements(className,newClass){const elements=document.getElementsByClassName(className);for(let i=0;i<elements.length;i++)elements[i].classList.remove(newClass)}function mapToggle(){var mapDiv;document.getElementById("map").classList.toggle("mapOpen")}function cameraToggle(){var cameraDiv;document.getElementById("camera").classList.toggle("cameraOpen")}function directionsPlayToggle(){var player=document.getElementById("audioDirections");player.classList.toggle("playing"),togglePlayPause(player)}function audioReset(){var player=document.getElementById("audioDirections");player.pause(),player.currentItem=0,player.src=""}function stepForward(){currentIndex<steps.length-1&&(currentIndex++,displayCurrentItem()),scrollToTop()}function stepBackward(){currentIndex>0&&(currentIndex--,displayCurrentItem()),scrollToTop()}function openDrawer(){document.getElementById("drawer").classList.add("open")}function closeDrawer(){document.getElementById("drawer").classList.remove("open")}function scrollToTop(){window.scrollTo(0,0)}answers.forEach(box=>{box.addEventListener("click",()=>{answers.forEach(b=>{const parentElement=box.parentElement,classNames=parentElement.classList,qid=classNames[1],abc=document.querySelectorAll(".options."+qid+" .answer");abc.forEach(def=>{def.classList.remove("answer-selected")}),qidForRadio=qid}),box.classList.add("answer-selected");let www,ele,boxNum=box.id.split("-")[1];const correspondingRadio=document.querySelector(`input[id="${qidForRadio}${boxNum}"]`);let ans;correspondingRadio.checked=!0,saveAnswer(qidForRadio+","+boxNum)})});var audio=document.getElementById("myAudio1");function togglePlayPause(audioElement){audioElement.paused?audioElement.play():audioElement.pause()}function fadePageToBlack(){var overlay;document.getElementById("overlay").style.opacity="1"}function extractQuestionID(inputString){const extractedText=inputString.substring(0,4);return extractedText}function extractTextBetweenBrackets(inputString){const startIndex=inputString.indexOf("["),endIndex=inputString.indexOf("]");if(-1!==startIndex&&-1!==endIndex){const extractedText=inputString.substring(startIndex+1,endIndex);return extractedText}return null}function removeQuestionID(inputString){const extractedText=inputString.slice(4,inputString.length);return extractedText}function removeTextInBrackets(inputString){const startIndex=inputString.indexOf("["),endIndex=inputString.indexOf("]");return-1!==startIndex&&-1!==endIndex?inputString.substring(0,startIndex)+inputString.substring(endIndex+1):inputString}function setTeamNameLocal(teamName){localStorage.setItem("team_name",teamName)}function getTeamNameLocal(teamName){return localStorage.getItem("team_name")}function createX(teamName){setTeamNameLocal(teamName),saveTeam(teamName)}const addTeam=document.getElementById("addTeamName"),previousButton=document.getElementById("previousButton"),nextButton=document.getElementById("nextButton"),mapSwitch=document.getElementById("mapToggle"),cameraSwitch=document.getElementById("cameraToggle"),directionsSwitch=document.getElementById("directionsToggle"),dialogBox=document.getElementById("dialogBox"),dialogMessage=document.getElementById("dialogMessage");addTeam.addEventListener("click",()=>{const teamName=document.getElementById("teamName");teamName.value?(createX(teamName.value),myDialog.showModal()):alert("Please enter a team name!")}),previousButton.addEventListener("click",()=>{stepBackward()}),nextButton.addEventListener("click",()=>{stepForward()}),mapSwitch.addEventListener("click",()=>{mapToggle()}),cameraSwitch.addEventListener("click",()=>{cameraToggle()}),directionsSwitch.addEventListener("click",()=>{directionsPlayToggle()});